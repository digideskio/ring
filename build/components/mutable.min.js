pw.component.register("mutable",function(e,t){this.mutation=function(t){if(!window.socket)return void e.node.submit();var o=pw.util.dup(t);delete o.__nested,delete o.scope,delete o.id;var n={};n[t.scope]=o;var i={action:"call_route",input:n};if("FORM"===e.node.tagName){var a,r=e.node.querySelector('input[name="_method"]');a=r?r.value:e.node.getAttribute("method"),i.method=a,i.uri=e.node.getAttribute("action")}var d=this;window.socket.send(i,function(e){if(302===e.status&&e.headers.Location!==window.location.pathname){var t=e.headers.Location;return void history.pushState({uri:t},t,t)}400===e.status||d.state.rollback(),pw.component.broadcast("response:received",{response:e})})}});
